# 🤖 AI Agent Guidance System - OpenPolicy Merge

## 🎯 **MISSION CONTROL: KEEPING AI AGENTS ON TRACK**

This document serves as the **SINGLE SOURCE OF TRUTH** for all AI agents working on the OpenPolicy Merge project. It ensures consistency, prevents confusion, and maintains development focus.

---

## 📋 **CORE PRINCIPLES**

### **1. PLAN BEFORE EXECUTE**
- ✅ **ALWAYS** review the comprehensive development plan before making changes
- ✅ **ALWAYS** check test coverage requirements before implementing features
- ✅ **ALWAYS** validate against acceptance criteria before proceeding
- ✅ **NEVER** skip planning phase or rush to implementation

### **2. TEST-DRIVEN DEVELOPMENT**
- ✅ **ALWAYS** write tests before implementing features
- ✅ **ALWAYS** ensure 100% test coverage for all components
- ✅ **ALWAYS** verify tests pass before committing code
- ✅ **NEVER** implement features without corresponding tests

### **3. DOCUMENTATION FIRST**
- ✅ **ALWAYS** update documentation when making changes
- ✅ **ALWAYS** maintain clear commit messages
- ✅ **ALWAYS** track progress in development logs
- ✅ **NEVER** make undocumented changes

### **4. CHECK BEFORE CREATE - CRITICAL RULE**
- ✅ **ALWAYS** search the entire codebase before creating ANY new file, script, or functionality
- ✅ **ALWAYS** verify that similar functionality doesn't already exist in any repository
- ✅ **ALWAYS** check for existing test plans, frameworks, or scripts before creating new ones
- ✅ **ALWAYS** adapt and improve existing code rather than creating duplicates
- ✅ **NEVER** create new functionality without first confirming it doesn't exist
- ✅ **NEVER** duplicate testing frameworks, plans, or scripts that already exist
- ✅ **NEVER** assume something needs to be created without thorough codebase search

---

## 🔍 **MANDATORY CODEBASE SEARCH PROTOCOL**

### **BEFORE CREATING ANYTHING NEW:**
```bash
# 1. Search for existing functionality
- [ ] Use semantic search for similar functionality
- [ ] Search for existing test files and frameworks
- [ ] Check for existing plans and documentation
- [ ] Look for similar scripts or tools

# 2. Verify uniqueness
- [ ] Confirm no duplicate functionality exists
- [ ] Check if existing code can be adapted
- [ ] Verify if existing code needs improvement instead
- [ ] Ensure we're not recreating existing work

# 3. Document findings
- [ ] List all existing similar functionality found
- [ ] Explain why new creation is necessary (if any)
- [ ] Document how existing code will be adapted/improved
- [ ] Update this guidance system with findings
```

### **EXISTING TESTING FRAMEWORKS IDENTIFIED:**
- ✅ `backend/tests/` - Comprehensive test directory structure
- ✅ `backend/tests/scrapers/federal/test_federal_scraping.py` - Federal scraper tests
- ✅ `backend/OpenPolicyAshBack/scraper_testing_framework.py` - Scraper testing framework
- ✅ `backend/OpenPolicyAshBack/scraper_monitoring_system.py` - Scraper monitoring system
- ✅ `backend/OpenPolicyAshBack/run_scraper_tests.py` - Test runner script
- ✅ `TEST_PLAN.md` - Comprehensive test plan
- ✅ `COMPREHENSIVE_TEST_PLAN.md` - Detailed test plan
- ✅ `COMPREHENSIVE_SCRIPT_TESTING_PLAN.md` - Script testing plan
- ✅ `COMPREHENSIVE_DEVELOPMENT_PLAN.md` - Development plan

### **EXISTING PLANS IDENTIFIED:**
- ✅ `SCRAPER_DEVELOPMENT_PLAN.md` - Scraper development plan
- ✅ `SCRAPER_DEVELOPMENT_SUMMARY.md` - Development summary
- ✅ `backend/OpenPolicyAshBack/COMPREHENSIVE_TESTING_PLAN.md` - Testing plan

---

## 🗺️ **DEVELOPMENT ROADMAP CHECKLIST**

### **CURRENT STATUS: PLANNING PHASE COMPLETE**
- ✅ Comprehensive Architecture Plan
- ✅ Comprehensive Test Plan
- ✅ Comprehensive Script Testing Plan
- ✅ Comprehensive Development Plan

### **NEXT PHASE: IMPLEMENTATION PHASE (Weeks 1-4)**

#### **Week 1: Script Testing Implementation**
```bash
# PRIORITY 1: Migration Script Tests
- [ ] test_migration_script_execution()
- [ ] test_backup_creation_success()
- [ ] test_schema_updates_applied()
- [ ] test_data_migration_complete()
- [ ] test_fresh_data_collection()

# PRIORITY 2: Scraper Script Tests
- [ ] test_scraper_script_execution()
- [ ] test_data_collection_from_source()
- [ ] test_database_insertion_success()
- [ ] test_data_validation_after_insertion()
- [ ] test_error_handling_for_failed_scrapes()

# PRIORITY 3: Deployment Script Tests
- [ ] test_deployment_script_execution()
- [ ] test_service_startup_success()
- [ ] test_database_connection_establishment()
- [ ] test_api_endpoint_availability()
- [ ] test_frontend_loading_success()
```

#### **Week 2: Database & API Testing Enhancement**
```bash
# PRIORITY 1: Enhanced Database Tests
- [ ] test_all_tables_exist()
- [ ] test_all_columns_exist()
- [ ] test_all_constraints_valid()
- [ ] test_all_foreign_keys_valid()
- [ ] test_all_indexes_created()

# PRIORITY 2: Enhanced API Tests
- [ ] test_login_success()
- [ ] test_login_invalid_credentials()
- [ ] test_token_validation()
- [ ] test_password_reset()
- [ ] test_account_creation()

# PRIORITY 3: Integration Tests
- [ ] test_scraper_to_database_flow()
- [ ] test_database_to_api_flow()
- [ ] test_api_to_frontend_flow()
- [ ] test_user_input_validation_flow()
- [ ] test_error_handling_flow()
```

---

## 🔍 **AI AGENT VALIDATION CHECKLIST**

### **BEFORE STARTING ANY TASK:**
```bash
# 1. Check Current Phase
- [ ] Verify we're in the correct development phase
- [ ] Check if prerequisites are met
- [ ] Validate against development plan

# 2. Review Test Requirements
- [ ] Check existing test coverage
- [ ] Verify test frameworks exist
- [ ] Ensure no duplicate testing is planned

# 3. Search Codebase for Existing Work
- [ ] Search for similar functionality
- [ ] Check for existing plans or frameworks
- [ ] Verify if adaptation is needed instead of creation
- [ ] Document findings in this guidance system

# 4. Validate Against Core Principles
- [ ] Confirm plan before execute
- [ ] Verify test-driven development approach
- [ ] Ensure documentation will be updated
- [ ] Confirm no duplicate work will be created
```

### **BEFORE CREATING ANY NEW FILE:**
```bash
# 1. Mandatory Codebase Search
- [ ] Search for similar files or functionality
- [ ] Check if existing code can be adapted
- [ ] Verify if improvement is needed instead of creation
- [ ] Document search results

# 2. Justification Required
- [ ] Explain why new file is necessary
- [ ] Document how it differs from existing work
- [ ] Confirm it's not duplicating existing functionality
- [ ] Update this guidance system with new findings
```

---

## 🚨 **CRITICAL REMINDERS**

### **DUPLICATE WORK PREVENTION:**
- 🚨 **NEVER** create a new testing framework without checking existing ones
- 🚨 **NEVER** create a new plan without checking existing plans
- 🚨 **NEVER** create a new script without checking existing scripts
- 🚨 **ALWAYS** adapt and improve existing work rather than recreating it
- 🚨 **ALWAYS** document why new creation is necessary (if any)

### **EXISTING WORK TO UTILIZE:**
- ✅ Use existing `scraper_testing_framework.py` for scraper testing
- ✅ Use existing `scraper_monitoring_system.py` for monitoring
- ✅ Use existing test plans and documentation
- ✅ Adapt existing test files in `backend/tests/` directory
- ✅ Improve existing functionality rather than creating new

---

## 📊 **CURRENT DEVELOPMENT STATUS**

### **COMPLETED:**
- ✅ Repository merge (9 repositories → 1 unified platform)
- ✅ Comprehensive architecture planning
- ✅ Comprehensive test planning
- ✅ Scraper testing framework creation
- ✅ Scraper monitoring system creation
- ✅ Centralized requirements management

### **IN PROGRESS:**
- 🔄 Scraper development and testing execution
- 🔄 Database migration and data integrity
- 🔄 API endpoint testing and validation

### **NEXT STEPS:**
- 📋 Execute existing scraper testing framework
- 📋 Run existing test plans and frameworks
- 📋 Improve and adapt existing functionality
- 📋 Focus on actual development work, not planning

---

**Remember**: The goal is to **EXECUTE** existing plans and frameworks, not create new ones. Focus on **DEVELOPMENT** and **TESTING** using what already exists!
